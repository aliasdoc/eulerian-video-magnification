Adapted from source code at
http://people.csail.mit.edu/mrub/vidmag/
